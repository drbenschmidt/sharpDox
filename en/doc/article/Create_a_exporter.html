









 

<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>sharpDox</title>
        <meta name="viewport" content="width=device-width">

		<link rel="stylesheet" type="text/css" href="../stylesheets/reset.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/font.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/font-awesome.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/typography.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/layout.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/elements.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/markdown.css" />
		<link rel="stylesheet" type="text/css" href="../stylesheets/vs.css" />

		<script src="../js/vendor/jquery.js"></script>
		<script src="../js/vendor/highlight.pack.js"></script>
		<script src="../js/Iframe.js"></script>

		<script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body>        
        
		<div id="documentation-wrapper">
			<div id="header">
				<h2 class="type-title">Create a exporter</h2>
				
					<span class="namespace-title">Version 0.9.8.2</span>
				
			</div>
			<div id="pagecontent">

				<h3 class="box-title first-heading">Article</h3>
				<div class="divider">
				<span></span>
				</div>

				<div class="text-box markdown">
					

					<p>This tutorial gives an overview about creating custom exporters for <strong>sharpDox</strong>. To accomplish this 
task we will develop a plugin which creates a new setting page, own settings and an exporter to 
create a csv output for each method in a solution.</p>

<p>First of all create a library project in Visual Studio and reference the <em>SharpDox.Model</em>, 
<em>SharpDox.Sdk</em>, <em>SharpDox.Ressources</em> and <em>System.Xaml</em>. In the first step we create the config 
class. Create a class <em>CSVConfig.cs</em> with the following content:</p>

<pre><code>using System;
using System.ComponentModel;
using SharpDox.Sdk.Config;

namespace CSVExporter
{
    // The class implements the interface IConfigSection
    public class CSVConfig : IConfigSection
    {
        // The ConfigController will register on this event to get notified
        // about any changes.
        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
        }

        // This is our new configitem
        private string _divider = string.Empty;
        public string Divider { get { return _divider; } set { _divider = value; OnPropertyChanged("Divider"); } }

        // This guid identifies the configsection in 
        // the config file.
        public Guid Guid { get { return new Guid("463e2a9d-5d26-42ac-8a02-012928988c79"); } }
    }
}
</code></pre>

<p>In this plugin we only create a setting to define the divider for the csv file.
To let the user choose this divider we will create a config page.</p>

<p>Create a wpf usercontrol, <em>CSVConfigPage</em>. Because of referencing the <em>SharpDox.Ressources</em> 
library we are able to use the wpf design of <strong>sharpDox</strong> in the new usercontrol. 
The following two examples show the implementation of the config page.</p>

<pre><code>using SharpDox.Sdk.UI;

namespace CSVExporter
{
    public partial class CSVConfigPage : IPage
    {
        public CSVConfigPage(CSVConfig csvConfig)
        {
            DataContext = csvConfig;
            InitializeComponent();
        }

        public string PageName { get { return "CSV"; } }
        public new int Height { get { return int.Parse(mainGrid.Height.ToString()); } }
        public new int Width { get { return int.Parse(mainGrid.Width.ToString()); } }
    }
}
</code></pre>

<p>Next the xaml file for the usercontrol:</p>

<pre><code>&lt;UserControl x:Class="CSVExporter.CSVConfigPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="50" d:DesignWidth="385"&gt;

    &lt;UserControl.Resources&gt;
        &lt;ResourceDictionary&gt;
            &lt;ResourceDictionary.MergedDictionaries&gt;
                &lt;ResourceDictionary Source="/SharpDox.Resources;component/Resources/SharpDox.xaml"/&gt;
            &lt;/ResourceDictionary.MergedDictionaries&gt;
        &lt;/ResourceDictionary&gt;
    &lt;/UserControl.Resources&gt;

    &lt;Grid Name="mainGrid" Height="50" Width="385"&gt;
        &lt;StackPanel Height="Auto" HorizontalAlignment="Left" Margin="15,0,15,0" Name="stackPanel2" VerticalAlignment="Top" Width="Auto"&gt;
            &lt;DockPanel Height="Auto" HorizontalAlignment="Left" Margin="0,0,0,0" Name="dockPanel1" VerticalAlignment="Top" Width="355"&gt;
                &lt;Label Content="Divider:" Width="150" Height="Auto" Name="label1" Style="{StaticResource BodyText}" /&gt;
                &lt;TextBox Height="Auto" Name="tbDivider" Width="Auto" DockPanel.Dock="Right" Tag="Divider" Text="{Binding Divider}" Style="{StaticResource TextBox}" /&gt;
            &lt;/DockPanel&gt;
        &lt;/StackPanel&gt;
    &lt;/Grid&gt;
&lt;/UserControl&gt;
</code></pre>

<p>The last step is to create the csv exporter. Create a new class <em>CSVExport.cs</em> with the following content:</p>

<pre><code>using System;
using System.IO;
using System.Linq;
using SharpDox.Model.Repository;
using SharpDox.Model.Repository.Types;
using SharpDox.Sdk.Exporter;

namespace CSVExporter
{
    public class CSVExport : IExporter
    {
        /// &lt;summary&gt;
        /// sharpDox listens on this event to get any status
        /// messages. All messages will be shown in the progressbar.
        /// &lt;/summary&gt;
        public event Action&lt;string&gt; OnStepMessage;

        /// &lt;summary&gt;
        /// sharpDox listens on this event to get any status update.
        /// This event will move forward the secondary progressbar.
        /// &lt;/summary&gt;
        public event Action&lt;int&gt; OnStepProgress;

        private readonly CSVConfig _csvConfig;

        public CSVExport(CSVConfig csvConfig)
        {
            // Get our new configuration
            _csvConfig = csvConfig;
        }

        // The export function gets the parsed solution and the  output path.
        public void Export(SDRepository repository, string outputPath)
        {
            var csv = string.Empty;
            var types = repository.GetAllTypes().OfType&lt;SDType&gt;().Where(o =&gt; !o.IsProjectStranger);

            foreach (var type in types)
            {
                ExecuteOnStepMessage("Creating entry for " + type.Fullname);
                csv += string.Format("{1}{0}{2}{0}{3}", _csvConfig.Divider, type.Fullname, type.Name, type.Namespace) + System.Environment.NewLine;
            }

            File.WriteAllText(Path.Combine(outputPath, "methods.csv"), csv);
        }

        private void ExecuteOnStepMessage(string message)
        {
            var handler = OnStepMessage;
            if (handler != null)
            {
                handler(message);
            }
        }

        private void ExecuteOnStepProgress(int progress)
        {
            var handler = OnStepProgress;
            if (handler != null)
            {
                handler(progress);
            }
        }

        // The name of the exporter will be used to 
        // create a subdirectory in the output path.
        public string ExporterName { get { return "csv"; } }

        // Name of the plugin author.
        // Used in the exporter selection.
        public string Author { get { return "Gerrit 'Geaz' Gazic"; } }

        // Small description of the plugin.
        // Used in the exporter selection.
        public string Description { get { return "A small csv example plugin for sharpDox"; } }
    }
}
</code></pre>

<p>This is the complete, simple plugin for <strong>sharpDox</strong>. Just copy the created dll file into the 
<em>plugin</em> folder of <strong>sharpDox</strong>. This way <strong>sharpDox</strong> knows about the plugin and will register 
it at the start. Please download the example on this site <a href="https://github.com/Geaz/SharpDox.Examples.Plugins.CVS" title="CSV-Exporter">here</a>.</p>

				</div>

			</div>
		</div>

    </body>
</html>

